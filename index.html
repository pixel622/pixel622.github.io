<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pok√©mon Amber: Orebound Chronicles</title>
    <style>
        :root {
            --gba-black: #080808;
            --ui-white: #f8f8f8;
            --ui-blue: #204070;
            --ui-border: #68a0b0;
            --font-pixel: 'Courier New', monospace;
        }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: var(--gba-black); overflow: hidden; touch-action: none; 
        }
        #stage {
            display: flex; justify-content: center; align-items: center;
            width: 100vw; height: 100vh;
        }
        canvas {
            image-rendering: pixelated;
            border: 6px solid #333;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            background: #000;
        }
        /* Touch Controls */
        #joy-pad {
            position: absolute; bottom: 40px; left: 40px;
            width: 150px; height: 150px;
            background: rgba(255,255,255,0.1); border-radius: 50%;
        }
        #action-cluster {
            position: absolute; bottom: 60px; right: 40px;
            display: flex; flex-direction: column; gap: 20px;
        }
        .joy-btn {
            width: 80px; height: 80px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            color: white; font-weight: bold; font-family: var(--font-pixel);
            border: 4px solid rgba(255,255,255,0.3);
            text-shadow: 2px 2px #000;
        }
        #btn-a { background: #d84040; transform: translateY(-20px); }
        #btn-b { background: #c0a030; width: 65px; height: 65px; }

        /* UI Dialogue */
        #dialogue-container {
            position: absolute; bottom: 10%; left: 50%;
            transform: translateX(-50%); width: 90%; max-width: 600px;
            height: 100px; background: var(--ui-white);
            border: 4px solid var(--ui-blue); border-radius: 8px;
            display: none; padding: 15px; box-sizing: border-box;
            z-index: 100; box-shadow: 0 0 0 4px white, 0 0 0 8px var(--ui-border);
        }
        #dialogue-text {
            font-family: var(--font-pixel); font-size: 1.2rem;
            color: #333; line-height: 1.4;
        }
        #shimmer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; opacity: 0; pointer-events: none;
            transition: opacity 0.2s; z-index: 999;
        }
    </style>
</head>
<body>

<div id="stage">
    <canvas id="gameCanvas"></canvas>
    <div id="shimmer"></div>

    <div id="dialogue-container">
        <div id="dialogue-text"></div>
    </div>

    <div id="joy-pad"></div>
    <div id="action-cluster">
        <div id="btn-a" class="joy-btn">A</div>
        <div id="btn-b" class="joy-btn">B</div>
    </div>
</div>

<script>
/** * POKEMON AMBER CORE ENGINE 
 * Author: Gemini
 * Concept: Orebound Region
 */

const CONFIG = {
    TILE_SIZE: 16,
    SCALE: 4,
    WIDTH: 240,
    HEIGHT: 160,
    FPS: 60
};

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = CONFIG.WIDTH * CONFIG.SCALE;
canvas.height = CONFIG.HEIGHT * CONFIG.SCALE;

// --- GAME DATA: MAPS & ENTITIES ---
const WORLD = {
    player: {
        x: 5, y: 5, 
        gridX: 5, gridY: 5,
        dir: 'down', 
        animFrame: 0,
        isMoving: false,
        moveSpeed: 0.1,
        inventory: ["Town Map"],
        pokemon: []
    },
    maps: {
        'MAPLE_HOUSE': {
            tiles: [
                [1,1,1,1,1,1,1,1,1,1],
                [1,4,4,4,4,4,4,4,4,1],
                [1,0,0,0,0,0,0,3,0,1], // 3 = Mom
                [1,0,0,0,0,0,0,0,0,1],
                [1,0,0,0,0,0,0,0,0,1],
                [1,1,1,1,2,2,1,1,1,1]  // 2 = Exit
            ],
            color: '#a08060'
        },
        'MAPLE_ROOT_TOWN': {
            tiles: Array(15).fill(0).map(() => Array(20).fill(0)),
            color: '#70a040'
        },
        'SEQUOIA_LAB_F1': {
            tiles: [
                [1,1,1,1,1,1,1,1],
                [1,0,0,0,0,0,0,1],
                [1,0,3,0,0,0,0,1], // Assistant
                [1,1,1,1,1,5,1,1], // 5 = Shimmer Door
                [1,0,0,0,0,0,0,1],
                [1,1,1,2,2,1,1,1]
            ],
            color: '#90a0b0'
        }
    }
};

// --- CORE SYSTEMS ---
const Game = {
    state: 'OVERWORLD', // OVERWORLD, DIALOGUE, MENU, BATTLE
    currentMap: 'MAPLE_HOUSE',
    
    init() {
        this.bindControls();
        this.loop();
        this.triggerDialogue([
            "Mom: Wake up, sleepyhead!",
            "A letter arrived from Professor Sequoia.",
            "He says it's URGENT. You should go to the Lab!"
        ]);
    },

    bindControls() {
        window.addEventListener('keydown', (e) => {
            if(this.state === 'DIALOGUE') {
                if(e.key === 'z' || e.key === 'Enter') this.advanceDialogue();
                return;
            }
            if(e.key === 'ArrowUp') this.move('up');
            if(e.key === 'ArrowDown') this.move('down');
            if(e.key === 'ArrowLeft') this.move('left');
            if(e.key === 'ArrowRight') this.move('right');
        });

        document.getElementById('btn-a').addEventListener('touchstart', (e) => {
            e.preventDefault();
            if(this.state === 'DIALOGUE') this.advanceDialogue();
            else this.interact();
        });
    },

    move(dir) {
        if(WORLD.player.isMoving) return;
        
        let targetX = WORLD.player.gridX;
        let targetY = WORLD.player.gridY;

        if(dir === 'up') targetY--;
        if(dir === 'down') targetY++;
        if(dir === 'left') targetX--;
        if(dir === 'right') targetX++;

        const map = WORLD.maps[this.currentMap];
        if(this.isWalkable(targetX, targetY, map)) {
            WORLD.player.gridX = targetX;
            WORLD.player.gridY = targetY;
            this.checkTileTrigger(targetX, targetY);
        }
    },

    isWalkable(x, y, map) {
        if(y < 0 || y >= map.tiles.length || x < 0 || x >= map.tiles[0].length) return false;
        return map.tiles[y][x] !== 1;
    },

    checkTileTrigger(x, y) {
        const tile = WORLD.maps[this.currentMap].tiles[y][x];
        if(tile === 2) this.transition('MAPLE_ROOT_TOWN', 10, 8);
        if(tile === 5) this.shimmerTransition('SEQUOIA_LAB_F2', 5, 5);
    },

    shimmerTransition(newMap, x, y) {
        const shim = document.getElementById('shimmer');
        shim.style.opacity = '1';
        setTimeout(() => {
            this.currentMap = newMap;
            WORLD.player.gridX = x;
            WORLD.player.gridY = y;
            shim.style.opacity = '0';
        }, 400);
    },

    triggerDialogue(lines) {
        this.state = 'DIALOGUE';
        this.dialogueQueue = lines;
        document.getElementById('dialogue-container').style.display = 'block';
        this.advanceDialogue();
    },

    advanceDialogue() {
        if(this.dialogueQueue.length > 0) {
            document.getElementById('dialogue-text').innerText = this.dialogueQueue.shift();
        } else {
            this.state = 'OVERWORLD';
            document.getElementById('dialogue-container').style.display = 'none';
        }
    },

    draw() {
        ctx.fillStyle = "#000";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        const map = WORLD.maps[this.currentMap];
        if(!map) return;

        // Render Background
        ctx.save();
        ctx.scale(CONFIG.SCALE, CONFIG.SCALE);
        
        for(let y = 0; y < map.tiles.length; y++) {
            for(let x = 0; x < map.tiles[y].length; x++) {
                const tile = map.tiles[y][x];
                ctx.fillStyle = tile === 1 ? '#444' : map.color;
                ctx.fillRect(x * CONFIG.TILE_SIZE, y * CONFIG.TILE_SIZE, CONFIG.TILE_SIZE, CONFIG.TILE_SIZE);
                
                // Add detail to specials
                if(tile === 5) {
                    ctx.fillStyle = 'rgba(255,255,255,0.5)';
                    ctx.fillRect(x * CONFIG.TILE_SIZE, y * CONFIG.TILE_SIZE, CONFIG.TILE_SIZE, CONFIG.TILE_SIZE);
                }
            }
        }

        // Render Player
        ctx.fillStyle = "cyan";
        ctx.fillRect(WORLD.player.gridX * CONFIG.TILE_SIZE + 2, WORLD.player.gridY * CONFIG.TILE_SIZE + 2, 12, 12);

        ctx.restore();
    },

    loop() {
        this.draw();
        requestAnimationFrame(() => this.loop());
    }
};

// Start the game
Game.init();
</script>
</body>
</html>
