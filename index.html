<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mobile Snow Ski FPS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body {
  margin: 0;
  overflow: hidden;
  background: #000;
  touch-action: none;
}
canvas {
  display: block;
}
.button {
  position: absolute;
  background: rgba(255,255,255,0.15);
  border: 2px solid rgba(255,255,255,0.4);
  border-radius: 50%;
  width: 70px;
  height: 70px;
  color: white;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
}
#left { bottom: 20px; left: 20px; }
#right { bottom: 20px; left: 110px; }
#faster { bottom: 110px; left: 65px; }
#slower { bottom: 20px; right: 20px; }
#shoot { bottom: 110px; right: 20px; }
#crosshair {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 6px;
  height: 6px;
  background: white;
  transform: translate(-50%, -50%);
}
</style>
</head>
<body>

<div id="left" class="button">‚¨ÖÔ∏è</div>
<div id="right" class="button">‚û°Ô∏è</div>
<div id="faster" class="button">‚è©</div>
<div id="slower" class="button">‚è∏Ô∏è</div>
<div id="shoot" class="button">üî´</div>
<div id="crosshair"></div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let yaw = 0;
let pitch = 0;
let speed = 2;
let x = 0;
let z = 0;
let bullets = [];
let enemies = [];

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
addEventListener("resize", resize);

// Touch look
let lastTouch = null;
canvas.addEventListener("touchstart", e => lastTouch = e.touches[0]);
canvas.addEventListener("touchmove", e => {
  if (!lastTouch) return;
  let t = e.touches[0];
  yaw += (t.clientX - lastTouch.clientX) * 0.002;
  pitch += (t.clientY - lastTouch.clientY) * 0.002;
  pitch = Math.max(-1.2, Math.min(1.2, pitch));
  lastTouch = t;
});
canvas.addEventListener("touchend", () => lastTouch = null);

// Buttons
const btn = id => document.getElementById(id);
let controls = { left:false, right:false, fast:false, slow:false };

["left","right","faster","slower"].forEach(id=>{
  btn(id).ontouchstart = () => controls[id==="left"?"left":id==="right"?"right":id==="faster"?"fast":"slow"] = true;
  btn(id).ontouchend = () => controls[id==="left"?"left":id==="right"?"right":id==="faster"?"fast":"slow"] = false;
});

btn("shoot").ontouchstart = () => {
  bullets.push({ x, z, dir: yaw });
};

// Spawn enemies
setInterval(()=>{
  enemies.push({
    x: (Math.random()-0.5)*20,
    z: z - 80 - Math.random()*50
  });
}, 2000);

function update() {
  if (controls.left) yaw += 0.04;
  if (controls.right) yaw -= 0.04;
  if (controls.fast) speed += 0.02;
  if (controls.slow) speed -= 0.02;
  speed = Math.max(1, Math.min(5, speed));

  z -= speed;
  x += Math.sin(yaw) * speed * 0.2;

  bullets.forEach(b=>{
    b.z -= 6;
    b.x += Math.sin(b.dir)*6;
  });

  bullets = bullets.filter(b => b.z > z-200);

  enemies = enemies.filter(e=>{
    bullets.forEach(b=>{
      if (Math.hypot(b.x-e.x, b.z-e.z) < 2) e.hit = true;
    });
    return !e.hit && e.z < z+10;
  });
}

function draw() {
  ctx.fillStyle = "#bcd";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // fog ground
  for (let i=0;i<200;i++) {
    let dz = i*4;
    let scale = 300/(dz+1);
    let sx = canvas.width/2 + (x*scale);
    let sy = canvas.height/2 + dz*2;
    ctx.fillStyle = `rgb(240,240,240)`;
    ctx.fillRect(sx-1000*scale, sy, 2000*scale, 2);
  }

  enemies.forEach(e=>{
    let dz = e.z - z;
    let dx = e.x - x;
    let scale = 300/(dz);
    if (scale<0) return;
    let sx = canvas.width/2 + dx*scale;
    let sy = canvas.height/2 + dz*2;
    ctx.fillStyle = "red";
    ctx.fillRect(sx-20*scale, sy-40*scale, 40*scale, 40*scale);
  });
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
